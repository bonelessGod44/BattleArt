<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Settings</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Configure the 'Inter' font and overall aesthetic */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            /* Light purple/blue background to match the overall site feel */
            background: linear-gradient(135deg, #a78bfa 0%, #d8b4fe 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1.5rem 1rem;
        }

        .main-container {
            width: 100%;
            max-width: 800px;
            background-color: white;
            border-radius: 1.5rem; /* Large rounded corners for the card */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden; /* Important to keep the banner's rounded corners consistent */
        }

        /* Styling the Banner Area */
        .banner {
            height: 180px;
            background: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%); /* Stronger gradient */
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.875rem; /* text-3xl */
            font-weight: 800; /* font-extrabold */
            padding: 1rem;
        }

        /* Profile Image container styling */
        .profile-img-container {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: #333;
            border: 4px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            flex-shrink: 0; /* Prevents shrinking in flex layout */
        }

        /* Toggle switch styling */
        /* ON state background (Indigo) */
        .toggle-label input:checked + .slider {
            background-color: #8b5cf6;
        }

        /* OFF state background (Pale Indigo) - for the track */
        .slider {
            background-color: #e0e7ff;
            transition: .4s;
        }

        /* Thumb (White Circle) - Now correctly styled to be visible in OFF state */
        .toggle-label .slider + span {
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
        }

        .file-input-wrapper input[type="file"] {
            display: none;
        }
    </style>
</head>
<body onload="initializeForm()">

    <div class="main-container">

        <!-- Epic Banner Section (NOW CORRECTLY INSIDE main-container) -->
        <div class="banner">
            Epic BattleArt Banner
            <!-- Change Banner Image Button -->
            <button class="absolute top-4 right-4 bg-white bg-opacity-30 backdrop-blur-sm text-white text-sm font-semibold py-2 px-3 rounded-xl shadow-md hover:bg-opacity-40 transition duration-200" onclick="displayMessage('Banner change functionality not implemented.', 'info')">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.218A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.218A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                Change Banner Image
            </button>
        </div>

        <!-- Main Content Area -->
        <form id="profileSettingsForm" onsubmit="saveProfile(event)" class="px-8 pt-6 pb-8 space-y-8">

            <!-- Profile Picture and Info Row -->
            <!-- Adjusted flex-col on mobile, flex-row on md screens -->
            <div class="flex flex-col md:flex-row items-start md:items-center space-y-6 md:space-y-0 md:space-x-6">

                <!-- Profile Image & Uploader (NEW: Centered) -->
                <!-- We use flex flex-col items-center here to center the button under the image -->
                <div class="flex flex-col items-center w-full md:w-auto">
                    <div id="profileImage" class="profile-img-container mb-3">
                        <!-- Placeholder for image/initials -->
                        <svg xmlns="http://www.w3.org/2000/svg" fill="#ddd" class="w-full h-full p-4" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0" />
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1" />
                        </svg>
                        <img id="editImagePreview" class="w-full h-full object-cover hidden" alt="Profile Avatar">
                    </div>

                    <!-- Visually appealing button for upload -->
                    <label for="profileUpload" class="file-input-wrapper text-sm font-bold py-2 px-4 text-purple-700 bg-purple-100 rounded-xl shadow-md hover:bg-purple-200 transition duration-150 cursor-pointer whitespace-nowrap">
                        Upload New Profile Image
                        <input type="file" id="profileUpload" accept="image/*" onchange="previewImage(event)">
                    </label>
                </div>

                <!-- Name and Email Fields -->
                <div class="flex-grow w-full md:w-auto mt-4 md:mt-0">
                    <div class="grid grid-cols-1 gap-4 items-end">
                        <!-- Name Field -->
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">Name</label>
                            <input type="text" id="fullName" value="Artist Name"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-purple-500 focus:border-purple-500">
                        </div>

                        <!-- Email Field with Re-verification Button -->
                        <div class="relative">
                            <label class="block text-xs font-medium text-gray-500 mb-1">Email</label>
                            <div class="flex space-x-2">
                                <input type="email" id="email" value="artist@battleart.com" disabled
                                       class="flex-grow px-3 py-2 border border-gray-200 rounded-lg text-sm bg-gray-50 text-gray-500 cursor-not-allowed">
                                <button type="button" onclick="sendReverification()"
                                        class="h-9 px-3 py-1 bg-purple-100 text-purple-600 font-medium rounded-lg hover:bg-purple-200 transition text-sm whitespace-nowrap shadow-sm">
                                    Re-verify
                                </button>
                            </div>
                            <p class="text-xs text-red-500 mt-1">Email changes will require re-verification.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Horizontal Separator -->
            <hr class="border-gray-200" />

            <!-- Privacy Settings Section -->
            <div>
                <h2 class="text-xl font-bold text-gray-700 mb-4">Privacy Settings</h2>

                <div class="space-y-3">

                    <!-- Toggle 1: Show Your art -->
                    <div class="flex justify-between items-center py-1">
                        <p class="text-gray-700 text-base">
                            > Show <strong class="font-extrabold">"Your art"</strong> tab publicly
                        </p>
                        <label class="toggle-label relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="toggleArt" class="sr-only peer" checked>
                            <!-- Track (Pale Indigo OFF, Purple ON) -->
                            <span class="slider w-11 h-6 rounded-full peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-purple-300"></span>
                            <!-- Thumb (White Circle) -->
                            <span class="absolute left-[2px] top-[2px] w-5 h-5 rounded-full transition-all peer-checked:translate-x-5"></span>
                        </label>
                    </div>

                    <!-- Toggle 2: Show History -->
                    <div class="flex justify-between items-center py-1">
                        <p class="text-gray-700 text-base">
                            > Show <strong class="font-extrabold">"History"</strong> tab publicly
                        </p>
                        <label class="toggle-label relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="toggleHistory" class="sr-only peer">
                            <!-- Track (Pale Indigo OFF, Purple ON) -->
                            <span class="slider w-11 h-6 rounded-full peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-purple-300"></span>
                            <!-- Thumb (White Circle) -->
                            <span class="absolute left-[2px] top-[2px] w-5 h-5 rounded-full transition-all peer-checked:translate-x-5"></span>
                        </label>
                    </div>

                    <!-- Toggle 3: Show Comments -->
                    <div class="flex justify-between items-center py-1">
                        <p class="text-gray-700 text-base">
                            > Show <strong class="font-extrabold">"Comments"</strong> tab publicly
                        </p>
                        <label class="toggle-label relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="toggleComments" class="sr-only peer" checked>
                            <!-- Track (Pale Indigo OFF, Purple ON) -->
                            <span class="slider w-11 h-6 rounded-full peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-purple-300"></span>
                            <!-- Thumb (White Circle) -->
                            <span class="absolute left-[2px] top-[2px] w-5 h-5 rounded-full transition-all peer-checked:translate-x-5"></span>
                        </label>
                    </div>

                    <p class="text-sm text-gray-500 pt-2">
                        *Toggling these off will hide the respective sections from other users viewing your profile.
                    </p>
                </div>
            </div>

            <!-- Status Message Box -->
            <div id="statusMessage" class="hidden p-3 rounded-lg text-sm font-medium transition-opacity duration-300"></div>

            <!-- Action Buttons -->
            <div class="pt-4 flex justify-center space-x-4 border-t border-gray-100">
                <!-- Save Changes Button (Purple) -->
                <button type="submit"
                        class="flex items-center px-6 py-2 bg-purple-600 text-white font-semibold rounded-xl shadow-lg hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 13.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    Save Changes
                </button>

                <!-- Cancel Button (Gray) -->
                <button type="button" onclick="resetForm()"
                        class="flex items-center px-6 py-2 bg-gray-600 text-white font-semibold rounded-xl shadow-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    Cancel
                </button>
            </div>
        </form>
    </div>

    <script>
        // Mock initial state (to reset to)
        const initialState = {
            fullName: "Artist Name",
            email: "artist@battleart.com",
            toggleArt: true,
            toggleHistory: false,
            toggleComments: true,
            avatarUrl: null
        };

        let userProfile = { ...initialState };

        /**
         * Initializes the form with the mock user data.
         */
        function initializeForm() {
            document.getElementById('fullName').value = userProfile.fullName;
            document.getElementById('email').value = userProfile.email;
            document.getElementById('toggleArt').checked = userProfile.toggleArt;
            document.getElementById('toggleHistory').checked = userProfile.toggleHistory;
            document.getElementById('toggleComments').checked = userProfile.toggleComments;
        }

        /**
         * Resets the form to its initial state.
         */
        function resetForm() {
            // Reset form inputs
            document.getElementById('fullName').value = initialState.fullName;
            document.getElementById('toggleArt').checked = initialState.toggleArt;
            document.getElementById('toggleHistory').checked = initialState.toggleHistory;
            document.getElementById('toggleComments').checked = initialState.toggleComments;

            // Reset the image preview
            const img = document.getElementById('editImagePreview');
            img.classList.add('hidden');
            img.removeAttribute('src');
            document.getElementById('profileUpload').value = '';

            // Reset profile state to initial state
            userProfile = { ...initialState };

            displayMessage("Changes discarded. Form reset.", 'info');
        }

        /**
         * Handles the form submission (Save Changes).
         * @param {Event} event - The form submission event.
         */
        function saveProfile(event) {
            event.preventDefault();

            // 1. Collect updated data from the form
            const newProfile = {
                fullName: document.getElementById('fullName').value,
                email: document.getElementById('email').value,
                toggleArt: document.getElementById('toggleArt').checked,
                toggleHistory: document.getElementById('toggleHistory').checked,
                toggleComments: document.getElementById('toggleComments').checked,
                avatarUrl: userProfile.avatarUrl
            };

            userProfile = newProfile;

            // 2. Simulate data saving delay
            displayMessage("Saving changes...", 'loading');

            setTimeout(() => {
                const successMessage = `Settings for **${userProfile.fullName}** saved successfully!`;
                displayMessage(successMessage, 'success');
            }, 1500);
        }

        /**
         * Handles the mock email re-verification action.
         */
        function sendReverification() {
            const email = document.getElementById('email').value;
            displayMessage(`Sending verification link to **${email}**. Check your inbox!`, 'info');
        }

        /**
         * Displays a status message to the user.
         * @param {string} message - The message content.
         * @param {string} type - 'success', 'error', 'info', or 'loading'.
         */
        function displayMessage(message, type) {
            const statusBox = document.getElementById('statusMessage');
            statusBox.textContent = message.replace(/\*\*(.*?)\*\*/g, '$1');
            statusBox.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800', 'bg-yellow-100', 'text-yellow-800');

            switch (type) {
                case 'success':
                    statusBox.classList.add('bg-green-100', 'text-green-800');
                    break;
                case 'error':
                    statusBox.classList.add('bg-red-100', 'text-red-800');
                    break;
                case 'loading':
                    statusBox.classList.add('bg-yellow-100', 'text-yellow-800');
                    break;
                case 'info':
                default:
                    statusBox.classList.add('bg-blue-100', 'text-blue-800');
                    break;
            }

            // Auto-hide the message after 5 seconds, but not if it's 'loading'
            if (type !== 'loading') {
                setTimeout(() => {
                    statusBox.classList.add('hidden');
                }, 5000);
            }
        }

        /**
         * Previews the selected image file in the avatar container.
         * @param {Event} event - The file input change event.
         */
        function previewImage(event) {
            const file = event.target.files[0];
            const imgElement = document.getElementById('editImagePreview');
            const defaultIcon = document.querySelector('.profile-img-container svg');

            if (file) {
                if (file.size > 5 * 1024 * 1024) {
                    displayMessage("Image file is too large. Max size is 5MB.", 'error');
                    event.target.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = function (e) {
                    // Update visual preview
                    imgElement.src = e.target.result;
                    imgElement.classList.remove('hidden');
                    defaultIcon.classList.add('hidden');

                    // Temporarily store the URL in state
                    userProfile.avatarUrl = e.target.result;
                }
                reader.readAsDataURL(file);
            } else {
                // Revert to the last saved/default image if selection is canceled
                if (userProfile.avatarUrl) {
                    imgElement.src = userProfile.avatarUrl;
                    imgElement.classList.remove('hidden');
                    defaultIcon.classList.add('hidden');
                } else {
                    imgElement.classList.add('hidden');
                    defaultIcon.classList.remove('hidden');
                }
            }
        }
    </script>

</body>
</html>
